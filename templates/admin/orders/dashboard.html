{% extends "admin/base_site.html" %}
{% load i18n %}
{% block title %}Orders Dashboard | {{ block.super }}{% endblock %}
{% block content %}
<div id="content" class="app-orders module">
  <h1>Orders Dashboard</h1>

  <div class="dashboard-cards">
    <div class="dash-card">
      <div class="small text-muted">Total Orders</div>
      <div style="font-size:28px;font-weight:700;">{{ stats.total_orders }}</div>
    </div>
    <div class="dash-card">
      <div class="small text-muted">Paid Orders</div>
      <div style="font-size:28px;font-weight:700;">{{ stats.total_paid_orders }}</div>
    </div>
    <div class="dash-card">
      <div class="small text-muted">Unpaid Orders</div>
      <div style="font-size:28px;font-weight:700;">{{ stats.total_unpaid_orders }}</div>
    </div>
    <div class="dash-card">
      <div class="small text-muted">Today Orders</div>
      <div style="font-size:28px;font-weight:700;">{{ stats.today_orders }}</div>
    </div>
    <div class="dash-card">
      <div class="small text-muted">Today Revenue</div>
      <div style="font-size:28px;font-weight:700;">{{ stats.today_revenue }}</div>
    </div>
  </div>

  <div class="module">
    <div class="section">
      <h2>Recent Orders</h2>
      <table class="adminlist dash-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>User</th>
            <th>Name</th>
            <th>Email</th>
            <th>City</th>
            <th>Status</th>
            <th>Created</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          {% for o in recent_orders %}
          <tr class="row{% cycle '1' '2' %}">
            <td><a href="{% url 'admin:orders_order_change' o.id %}">#{{ o.id }}</a></td>
            <td>{% if o.user_id %}{{ o.user.username }}{% endif %}</td>
            <td>{{ o.first_name }} {{ o.last_name }}</td>
            <td>{{ o.email }}</td>
            <td>{{ o.city }}</td>
            <td>
              {% if o.paid %}
                <span class="badge-paid">PAID</span>
              {% else %}
                <span class="badge-unpaid">UNPAID</span>
              {% endif %}
            </td>
            <td>{{ o.created|date:"Y-m-d H:i" }}</td>
            <td>{{ o.get_total_cost }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="8" class="empty-row">No orders yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
      <p class="dash-actions">
        <a class="button" href="{% url 'admin:orders_order_changelist' %}">Go to Orders list</a>
      </p>
    </div>
  </div>
</div>
{% endblock %}
